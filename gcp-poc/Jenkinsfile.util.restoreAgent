#!/usr/bin/env groovy

def call(agent_id, agent_name, blob_file){
    def apiPreparation = load "${env.WORKSPACE}/Automation/gcp-poc/Jenkinsfile.util.apiPreparation"
    def restore_agent = apiPreparation(agent_id)[1]
    def payload = """{
        "agentUri": "gs://${PREPROD_BUCKET}/dialogflowcx/preprod/${params.version}/create/${agent_name}/${blob_file}"
        }"""
    restore_agent.setRequestMethod("POST")
    restore_agent.setDoOutput(true)
    restore_agent.getOutputStream().write(payload.getBytes("UTF-8"))
}
return this